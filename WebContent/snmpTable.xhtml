<!DOCTYPE html>
<html lang="en"
    xmlns="http://www.w3.org/1999/xhtml"
    xmlns:f="http://java.sun.com/jsf/core"
    xmlns:h="http://java.sun.com/jsf/html"
    xmlns:ui="http://java.sun.com/jsf/facelets"
    xmlns:p="http://primefaces.org/ui"
    xmlns:dt="http://dtools.com/ui">
    <h:head>
        <title>DTools</title>
    </h:head>
    <h:body>
    	
    	<h:outputStylesheet library="default" name="css/dstyles.css"/>
    	<h:outputStylesheet library="default" name="css/icons.css"/>
    	<h:outputStylesheet library="default" name="css/fonts.css"/>
    	
    	<p:growl id="growl" life="2000"/>
    	
    	<h:panelGrid columns="1" cellpadding="5" cellspacing="0" width="100%">
    		
    		<ui:include src="/include/ptoolbar.xhtml"/>
    		
    		<p:breadCrumb>
			    <p:menuitem value="Home" url="home.xhtml" />
			    <p:menuitem value="SNMP Simulator" url="snmpSimulator.xhtml" />
			    <p:menuitem value="#{snmpTableBean.agent.name}" url="snmpAgent.xhtml?agent=#{snmpTableBean.agent.name}" />
			    <p:menuitem value="#{snmpTableBean.table.name}" url="#" />
			</p:breadCrumb>
    		
			
			<h:outputText value="SNMP Agent Table: #{snmpTableBean.table.name}" styleClass="title" />
			
			
			
			<h:form>
				<p:button value="Edit Table" outcome="snmpTableMetadata">
					<f:param name="agent" value="#{snmpTableBean.agent.name}" />
					<f:param name="snmpTableName" value="#{snmpTableBean.table.name}" />
				</p:button>
				<p:commandButton value="Net-SNMP help" oncomplete="PF('helpDlg').show();" />
			</h:form>
			
			
			<h:form id="helpForm">
	        	<p:dialog header="Net-SNMP help" widgetVar="helpDlg" resizable="false" dynamic="true" closable="true">
	        		<h:panelGrid columns="1" width="100%">
	        			<h:inputTextarea value="#{snmpTableBean.generateNetSnmpHelp()}" 
							cols="100" rows="5" styleClass="codeStyle" readonly="true" />
	        		</h:panelGrid>
					<f:facet name="footer">
				    	<p:commandButton value="Ok" onclick="PF('trapInfoDlg').hide();" />
				    </f:facet>
				</p:dialog>
        	</h:form>
			
			
			<hr/>
			
			<h:outputText value="Table OID: #{snmpTableBean.table.metadata.tableOid}" />

			
			
			<h:form id="mainForm">
			
				<h:panelGrid columns="1" cellspacing="5" width="100%">
					<p:dataTable id="tbl" value="#{snmpTableBean.rows}" var="row" >
						<p:columns value="#{snmpTableBean.columns}" var="col" headerText="#{col}" >
							<p:inplace editor="true">
						        <p:inputText value="#{row[col]}" required="false" label="text"
						        	valueChangeListener="#{snmpTableBean.tableValueChanged}" >
						        	<f:attribute name="row" value="#{row}" />
									<f:attribute name="col" value="#{col}" />
						        </p:inputText>
						    </p:inplace>
						</p:columns>
						<p:column>
							<f:facet name="header">Action</f:facet>
								<p:commandButton value="Remove row" 
									action="#{snmpTableBean.deleteRow(row)}" 
									update="mainForm" ajax="true" >
								</p:commandButton>
						</p:column>
					</p:dataTable>
				</h:panelGrid>
				
				<h:panelGrid columns="3" cellpadding="3" cellspacing="3">
		            	<p:commandButton value="Add row" 
							action="#{snmpTableBean.addNewRow()}" 
							update="mainForm growl" ajax="true" />
						<p:commandButton value="Save table" 
							action="#{snmpTableBean.saveTable()}"
							update="growl mainForm" ajax="true" >
						</p:commandButton>
						<p:button value="Cancel" outcome="snmpAgent" >
							<f:param name="agent" value="#{snmpTableBean.agent.name}" />
						</p:button>
		            </h:panelGrid>
				
			</h:form>
			
        
        </h:panelGrid>
        
    </h:body>
</html>
